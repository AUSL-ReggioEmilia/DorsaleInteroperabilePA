// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace DI.BiztalkMonitor.Site.Components
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using DI.BiztalkMonitor.Site;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using DI.BiztalkMonitor.Site.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using DI.BiztalkMonitor.Site.Classes;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using DI.BiztalkMonitor.Site.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using DI.BiztalkMonitor.DataAccess;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using DI.BiztalkMonitor.DataAccess.Adapters;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using DI.BiztalkMonitor.DataAccess.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using DI.BiztalkMonitor.DataAccess.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\_Imports.razor"
using Microsoft.Extensions.Logging;

#line default
#line hidden
#nullable disable
    public partial class Grid<TableItem> : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 119 "C:\Users\sandro\Source\Repos\DorsaleInteroperabilePA\Git\src\PortaleAdmin\v3\DI.BiztalkMonitor.Site\Components\Grid.razor"
      

	int _totalPages;
	int _curPage;
	int _pagerSize;

	int _startPage;
	int _endPage;

	IEnumerable<TableItem> _currentItemList { get; set; }

	//
	// Parametri
	//

	/// <summary>
	/// Se impostata a true attiva l'autobind della property RowCss con il modello passato
	/// Se il modello ha la propietà RowCss allora la stringa RowCss viene applicata all'intera riga come classi CSS
	/// </summary>
	[Parameter] public bool RowCssActive { get; set; }

	/// <summary>
	/// CSS for table
	/// </summary>
	[Parameter] public string CssClass { get; set; }

	/// <summary>
	/// Header for BlazorGrid.
	/// </summary>
	[Parameter] public RenderFragment GridHeader { get; set; }

	/// <summary>
	/// Rows for BlazorGrid.
	/// </summary>
	[Parameter]
	public RenderFragment<TableItem> GridRow { get; set; }

	private IEnumerable<TableItem> _items;

	[Parameter]
	public IEnumerable<TableItem> Items
	{
		get { return _items; }
		set
		{
			_items = value;

			//Paginazione
			if (value != null)
			{
				_pagerSize = 10;
				if (_curPage == 0)
					_curPage = 1;

				_startPage = 0;
				_endPage = 0;

				_totalPages = (int)Math.Ceiling(Items.Count() / (decimal)PageSize);

				if (_totalPages < _curPage)
					_curPage--;
				_currentItemList = Items.Skip((_curPage - 1) * PageSize).Take(PageSize);

				SetPagerSize("forward");
			}
			else
			{
				//Lista vuota, animazione di ricerca
				_currentItemList = null;
			}
		}
	}

	/// <summary>
	/// Empty text for BlazorGrid.
	/// </summary>
	[Parameter] public RenderFragment Empty { get; set; }

	/// <summary>
	/// Size of each page of BlazorGrid. This is a required field.
	/// </summary>
	[Parameter]
	public int PageSize { get; set; } = 10;

	/// <summary>
	/// Abilita la paginazione
	/// </summary>
	[Parameter]
	public bool AllowPaging { get; set; }

	//PER CARICAMENTO

	/// <summary>
	/// Numero di header.. necessario per la preview della tabella
	/// </summary>
	[Parameter]
	public int HeaderNumber { get; set; } = 5;

	[Parameter]
	public int RowHeight { get; set; } = 1;

	void UpdateItemList(int currentPage)
	{
		//
		// Aggiorno la lista degli elementi correnti
		//
		// NOTA BENE:
		// utilizzo un metodo asincrono perchè l'ordinamento potrebbe impiegare
		// del tempo, quindi libero il thread per altro
		//

		_currentItemList = Items.Skip((currentPage - 1) * PageSize).Take(PageSize);
		_curPage = currentPage;
		StateHasChanged();
	}

	void SetPagerSize(string direction)
	{
		//
		// Aggiorno il numero della pagine visualizzate in base alla direzione passata
		//

		if (direction == "forward" && _endPage < _totalPages)
		{
			_startPage = _endPage + 1;
			if (_endPage + _pagerSize < _totalPages)
			{
				_endPage = _startPage + _pagerSize - 1;
			}
			else
			{
				_endPage = _totalPages;
			}
			StateHasChanged();
		}
		else if (direction == "back" && _startPage > 1)
		{
			_endPage = _startPage - 1;
			_startPage = _startPage - _pagerSize;
		}

	}

	void NavigateToPage(string direction)
	{
		if (direction == "next")
		{
			if (_curPage < _totalPages)
			{
				if (_curPage == _endPage)
				{
					SetPagerSize("forward");
				}
				_curPage += 1;
			}
		}
		else if (direction == "previous")
		{
			if (_curPage > 1)
			{
				if (_curPage == _startPage)
				{
					SetPagerSize("back");
				}
				_curPage -= 1;
			}
		}

		// Aggiorno la lista degli elementi correnti
		UpdateItemList(_curPage);
	}

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
